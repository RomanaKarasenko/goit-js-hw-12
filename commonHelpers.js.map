{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["// Описані у документації\nimport iziToast from 'izitoast';\n// Додатковий імпорт стилів\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport axios from 'axios';\n\n// Описані у документації\nimport SimpleLightbox from 'simplelightbox';\n// Додатковий імпорт стилів\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst fetchPicturesForm = document.querySelector('.form');\nconst gallery = document.querySelector('.gallery');\nconst userInput = document.querySelector('input');\nconst containerDiv = document.querySelector('.container');\nconst loadMoreBtn = document.querySelector('.btn-load');\n\nlet page = 1;\nlet per_page = 40;\n\nconst scrollToGallery = () => {\n  const { height: cardHeight } = document\n    .querySelector('.gallery')\n    .firstElementChild.getBoundingClientRect();\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n};\n\nconst shouldHideLoadMoreButton = (loadedImagesCount, totalImagesCount) => {\n  return loadedImagesCount >= totalImagesCount;\n};\n\nconst renderPhotos = async data => {\n  const markup = data.hits\n    .map(data => {\n      return `<li class=\"gallery-item\"><a href=\"${data.webformatURL}\">\n            <img class=\"gallery-image\" src=\"${data.webformatURL}\" alt=\"${data.tags}\"></a>\n            <p><b>Likes: </b>${data.likes}</p>\n            <p><b>Views: </b>${data.views}</p>\n            <p><b>Comments: </b>${data.comments}</p>\n            <p><b>Downloads: </b>${data.downloads}</p>\n            </li>`;\n    })\n    .join('');\n\n  if (lightbox) {\n    lightbox.destroy();\n  }\n\n  gallery.insertAdjacentHTML('beforeend', markup);\n  lightbox = new SimpleLightbox('.gallery a', options);\n  lightbox.on('show.simplelightbox');\n  await lightbox.refresh();\n};\n\nconst fetchPhotos = async userQuery => {\n  const params = new URLSearchParams({\n    page: page,\n    per_page: per_page,\n  });\n  const apiKey = '22866492-0a616de8c4fefaa29c0c168ad';\n  const query = userQuery || userInput.value;\n  const response = await axios.get(\n    `https://pixabay.com/api/?key=${apiKey}&q=${encodeURIComponent(\n      query\n    )}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=${per_page}`\n  );\n  return response.data;\n};\n\nlet lightbox;\nlet userQuery = '';\n\nconst options = {\n  captions: true,\n  captionSelector: 'img',\n  captionType: 'attr',\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  animation: 250,\n};\n\nfetchPicturesForm.addEventListener('submit', async e => {\n  showLoader();\n  page = 1;\n  e.preventDefault();\n  gallery.innerHTML = '';\n  userQuery = userInput.value;\n\n  try {\n    const photos = await fetchPhotos(userQuery);\n    await renderPhotos(photos);\n    fetchPicturesForm.reset();\n    hideLoader();\n    showLoadMoreButton();\n\n    if (photos.hits.length === 0) {\n      iziToast.error({\n        title: '',\n        backgroundColor: '#EF4040',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n\n      scrollToGallery();\n    }\n    if (shouldHideLoadMoreButton(gallery.children.length, photos.totalHits)) {\n      hideLoadMoreButton();\n    } else {\n      showLoadMoreButton();\n    }\n  } catch (error) {\n    console.log(error);\n    hideLoadMoreButton();\n  }\n});\n\nloadMoreBtn.addEventListener('click', async () => {\n  showLoader();\n  try {\n    page += 1;\n    const photos = await fetchPhotos();\n    await renderPhotos(photos);\n    hideLoader();\n\n    scrollToGallery();\n\n    if (gallery.children.length >= photos.totalHits) {\n      iziToast.warning({\n        title: '',\n        message:\n          'We are sorry, but you have reached the end of search results.',\n      });\n      hideLoadMoreButton();\n    }\n  } catch (error) {\n    console.log(error);\n    hideLoader();\n    hideLoadMoreButton();\n  }\n});\nconst showLoader = () => {\n  const loader = document.createElement('span');\n  loader.classList.add('loader');\n  containerDiv.append(loader);\n};\n\nconst hideLoader = () => {\n  const loader = document.querySelector('.loader');\n  if (loader) {\n    loader.remove();\n  }\n};\n\nconst showLoadMoreButton = () => {\n  loadMoreBtn.style.display = 'block';\n};\n\nconst hideLoadMoreButton = () => {\n  loadMoreBtn.style.display = 'none';\n};\n"],"names":["fetchPicturesForm","gallery","userInput","containerDiv","loadMoreBtn","page","per_page","scrollToGallery","cardHeight","shouldHideLoadMoreButton","loadedImagesCount","totalImagesCount","renderPhotos","data","markup","lightbox","SimpleLightbox","options","fetchPhotos","userQuery","apiKey","query","axios","showLoader","photos","hideLoader","showLoadMoreButton","iziToast","hideLoadMoreButton","error","loader"],"mappings":"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"}