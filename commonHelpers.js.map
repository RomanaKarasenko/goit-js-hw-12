{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport axios from 'axios';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst fetchPicturesForm = document.querySelector('.form');\nconst gallery = document.querySelector('.gallery');\nconst userInput = document.querySelector('input');\nconst containerDiv = document.querySelector('.container');\nconst loadMoreBtn = document.querySelector('.btn-load');\n\nlet currentPage = 1;\nconst itemsPerPage = 15;\nlet lightbox;\nlet userQuery = '';\n\nconst lightboxOptions = {\n  captions: true,\n  captionSelector: 'img',\n  captionType: 'attr',\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  animation: 250,\n};\n\nconst scrollToGallery = () => {\n  const { height: cardHeight } = document\n    .querySelector('.gallery')\n    .firstElementChild.getBoundingClientRect();\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n};\n\nconst toggleLoader = show => {\n  const loader = document.querySelector('.loader');\n  if (loader) {\n    if (show) {\n      loader.classList.remove('is-hidden');\n    } else {\n      loader.classList.add('is-hidden');\n    }\n  }\n};\n\nconst updateDomWithMarkup = markup => {\n  if (lightbox) {\n    lightbox.destroy();\n  }\n  gallery.insertAdjacentHTML('beforeend', markup);\n  lightbox = new SimpleLightbox('.gallery a', lightboxOptions);\n  lightbox.on('show.simplelightbox');\n  lightbox.refresh();\n};\n\nconst renderGalleryItems = async data => {\n  const markup = data.hits\n    .map(\n      item => `<li class=\"gallery-item\"><a href=\"${item.largeImageURL}\">\n            <img class=\"gallery-image\" src=\"${item.webformatURL}\" alt=\"${item.tags}\"></a>\n            <p><b>Likes: </b>${item.likes}</p>\n            <p><b>Views: </b>${item.views}</p>\n            <p><b>Comments: </b>${item.comments}</p>\n            <p><b>Downloads: </b>${item.downloads}</p>\n            </li>`\n    )\n    .join('');\n\n  updateDomWithMarkup(markup);\n};\n\nconst fetchImages = async (userQuery, currentPage) => {\n  const apiKey = '22866492-0a616de8c4fefaa29c0c168ad';\n  const query = userQuery || userInput.value;\n  const response = await axios.get(\n    `https://pixabay.com/api/?key=${apiKey}&q=${encodeURIComponent(\n      query\n    )}&image_type=photo&orientation=horizontal&safesearch=true&page=${currentPage}&per_page=${itemsPerPage}`\n  );\n  return response.data;\n};\n\nconst showLoadMoreButton = () => {\n  loadMoreBtn.style.display = 'block';\n};\n\nconst hideLoadMoreButton = () => {\n  loadMoreBtn.style.display = 'none';\n};\n\nconst showEndOfResultsMessage = () => {\n  iziToast.info({\n    title: '',\n    message: \"We're sorry, but you've reached the end of search results.\",\n  });\n};\n\nconst showErrorToast = () => {\n  iziToast.error({\n    title: '',\n    backgroundColor: '#EF4040',\n    message: 'An error occurred while loading images. Please try again.',\n  });\n};\n\nfetchPicturesForm.addEventListener('submit', async e => {\n  e.preventDefault();\n\n  if (!userInput.value.trim()) {\n    iziToast.warning({\n      title: '',\n      message: 'Enter a keyword to search.',\n    });\n    return;\n  }\n\n  toggleLoader(true);\n  currentPage = 1;\n  gallery.innerHTML = '';\n  userQuery = userInput.value;\n\n  try {\n    const images = await fetchImages(userQuery, currentPage);\n    renderGalleryItems(images);\n    fetchPicturesForm.reset();\n    toggleLoader(false);\n    showLoadMoreButton();\n\n    if (images.hits.length === 0) {\n      iziToast.error({\n        title: '',\n        backgroundColor: '#EF4040',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n      scrollToGallery();\n    }\n\n    if (images.hits.length < itemsPerPage) {\n      hideLoadMoreButton();\n    } else {\n      showLoadMoreButton();\n    }\n  } catch (error) {\n    console.error(error);\n    showErrorToast();\n    toggleLoader(false);\n    hideLoadMoreButton();\n  }\n});\n\nloadMoreBtn.addEventListener('click', async () => {\n  toggleLoader(true);\n  try {\n    currentPage += 1;\n    const images = await fetchImages(userQuery, currentPage);\n    renderGalleryItems(images);\n    toggleLoader(false);\n\n    scrollToGallery();\n\n    if (images.hits.length < itemsPerPage) {\n      showEndOfResultsMessage();\n      hideLoadMoreButton();\n    }\n  } catch (error) {\n    console.error(error);\n    showErrorToast();\n    toggleLoader(false);\n    hideLoadMoreButton();\n  }\n});\n"],"names":["fetchPicturesForm","gallery","userInput","loadMoreBtn","currentPage","itemsPerPage","lightbox","userQuery","lightboxOptions","scrollToGallery","cardHeight","toggleLoader","show","loader","updateDomWithMarkup","markup","SimpleLightbox","renderGalleryItems","data","item","fetchImages","apiKey","query","axios","showLoadMoreButton","hideLoadMoreButton","showEndOfResultsMessage","iziToast","showErrorToast","images","error"],"mappings":"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"}